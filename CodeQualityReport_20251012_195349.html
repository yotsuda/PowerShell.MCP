<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C#コード品質分析レポート - PowerShell.MCP</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #34495e; margin-top: 30px; border-left: 4px solid #3498db; padding-left: 15px; }
        h3 { color: #7f8c8d; }
        .summary { background: #ecf0f1; padding: 20px; border-radius: 5px; margin: 20px 0; }
        .metric { display: inline-block; margin: 10px 20px 10px 0; }
        .metric-label { font-weight: bold; color: #7f8c8d; }
        .metric-value { font-size: 1.5em; color: #2c3e50; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th { background: #3498db; color: white; padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid #ecf0f1; }
        tr:hover { background: #f8f9fa; }
        .score-high { color: #27ae60; font-weight: bold; }
        .score-medium { color: #f39c12; font-weight: bold; }
        .score-low { color: #e74c3c; font-weight: bold; }
        .priority-high { background: #ffe5e5; }
        .priority-medium { background: #fff9e5; }
        .priority-low { background: #e5ffe5; }
        .recommendation { background: #e8f4fd; border-left: 4px solid #3498db; padding: 15px; margin: 10px 0; }
        .issue { background: #fff3cd; border-left: 4px solid #ffc107; padding: 10px; margin: 5px 0; }
        .success { background: #d4edda; border-left: 4px solid #28a745; padding: 10px; margin: 5px 0; }
        .chart { margin: 20px 0; }
    </style>
</head>
<body>
<div class="container">
    <h1>🔍 C#コード品質分析レポート</h1>
    <p><strong>プロジェクト:</strong> PowerShell.MCP</p>
    <p><strong>分析日時:</strong> 2025年10月12日 19:53:49</p>
    <p><strong>分析対象:</strong> 27ファイル（自動生成コードを除く）</p>

    <div class="summary">
        <h2>📊 概要サマリー</h2>
        <div class="metric">
            <div class="metric-label">総コード行数</div>
            <div class="metric-value">3,230行</div>
        </div>
        <div class="metric">
            <div class="metric-label">平均品質スコア</div>
            <div class="metric-value class="score-high">105.9/100</div>
        </div>
        <div class="metric">
            <div class="metric-label">プロジェクト数</div>
            <div class="metric-value">3個</div>
        </div>
        <div class="metric">
            <div class="metric-label">最大ネストレベル</div>
            <div class="metric-value">8</div>
        </div>
    </div>

    <h2>✅ 良好な点</h2>
    <div class="success">
        <strong>✓ 全体的な品質が高い:</strong> 平均スコア105.9/100は優秀な結果です
    </div>
    <div class="success">
        <strong>✓ セキュリティ:</strong> 重大なセキュリティ問題は検出されませんでした
    </div>
    <div class="success">
        <strong>✓ 設計パターン:</strong> Cmdletで基底クラス（TextFileCmdletBase）を活用した良好な設計
    </div>
    <div class="success">
        <strong>✓ コメント率:</strong> 多くのファイルで適切なコメントが記載されています
    </div>

    <h2>⚠️ 改善が必要な領域</h2>    <h3>1. 高複雑度ファイル</h3>
    <div class="issue">
        <strong>TextFileUtility.cs</strong> - ネストレベル8（推奨: 4以下）<br>
        448行のコードに13メソッドが含まれており、複雑度が高すぎます<br>
        <em>推奨アクション:</em> メソッドの分割、ヘルパークラスへの機能移譲を検討
    </div>
    <div class="issue">
        <strong>PowerShellProcessManager.cs</strong> - ネストレベル6<br>
        プロセス管理の複雑なロジックが含まれています<br>
        <em>推奨アクション:</em> 状態管理を別クラスに分離することを検討
    </div>

    <h3>2. XMLドキュメントコメント不足</h3>
    <table>
        <tr>
            <th>ファイル</th>
            <th>クラス数</th>
            <th>XMLコメント数</th>
            <th>状態</th>
        </tr>
        <tr class="priority-high">
            <td>Program.cs</td>
            <td>1</td>
            <td>0</td>
            <td>❌ 不足</td>
        </tr>
        <tr class="priority-high">
            <td>JsonRpcModels.cs</td>
            <td>4</td>
            <td>0</td>
            <td>❌ 不足</td>
        </tr>
        <tr class="priority-high">
            <td>PowerShellPrompts.cs</td>
            <td>2</td>
            <td>0</td>
            <td>❌ 不足</td>
        </tr>
        <tr class="priority-high">
            <td>PowerShellService.cs</td>
            <td>1</td>
            <td>0</td>
            <td>❌ 不足</td>
        </tr>
        <tr class="priority-high">
            <td>PowerShellTools.cs</td>
            <td>1</td>
            <td>0</td>
            <td>❌ 不足</td>
        </tr>
    </table>

    <h3>3. 命名規則</h3>
    <div class="issue">
        <strong>プライベートフィールド:</strong> 多くのファイルでプライベートフィールドがアンダースコア（_）で始まっていません<br>
        C#の標準的な命名規則では、プライベートフィールドは「_camelCase」形式が推奨されます<br>
        影響ファイル数: 12個
    </div>

    <h3>4. エラーハンドリング</h3>
    <div class="issue">
        <strong>PowerShellPrompts.cs</strong> (312行) - try-catchブロックなし<br>
        <strong>PowerShellService.cs</strong> (53行) - try-catchブロックなし<br>
        <em>推奨アクション:</em> 外部システムとの通信を含むコードには適切な例外処理を追加
    </div>

    <h3>5. 大規模ファイル</h3>
    <table>
        <tr>
            <th>ファイル</th>
            <th>コード行数</th>
            <th>推奨最大</th>
            <th>超過</th>
        </tr>
        <tr class="priority-high">
            <td>TextFileUtility.cs</td>
            <td>448</td>
            <td>300</td>
            <td>+148行</td>
        </tr>
        <tr class="priority-medium">
            <td>PowerShellPrompts.cs</td>
            <td>312</td>
            <td>300</td>
            <td>+12行</td>
        </tr>
    </table>

    <h3>6. コメントアウトされたコード</h3>
    <div class="issue">
        <strong>NotificationService.cs</strong> - 86行中74行がコメントアウト<br>
        このファイルは実装が保留中の可能性があります<br>
        <em>推奨アクション:</em> 不要な場合は削除、必要な場合は実装を完了させる
    </div>    <h2>🎯 優先度付きアクションプラン</h2>

    <div class="recommendation">
        <h3>🔴 優先度: 高（直ちに対応を推奨）</h3>
        <ol>
            <li><strong>TextFileUtility.cs のリファクタリング</strong>
                <ul>
                    <li>448行のコードを複数のヘルパークラスに分割</li>
                    <li>ネストレベルを8から4以下に削減</li>
                    <li>各メソッドを50行以下に収める</li>
                    <li>推定工数: 8時間</li>
                </ul>
            </li>
            <li><strong>XMLドキュメントコメントの追加</strong>
                <ul>
                    <li>PowerShellPrompts.cs、PowerShellService.cs、PowerShellTools.csにXMLコメント追加</li>
                    <li>すべてのpublicクラスとメソッドに&lt;summary&gt;タグを追加</li>
                    <li>推定工数: 4時間</li>
                </ul>
            </li>
        </ol>
    </div>

    <div class="recommendation">
        <h3>🟡 優先度: 中（次回リリース前に対応）</h3>
        <ol>
            <li><strong>命名規則の統一</strong>
                <ul>
                    <li>プライベートフィールドを_camelCase形式に変更</li>
                    <li>影響: 12ファイル</li>
                    <li>推定工数: 2時間</li>
                </ul>
            </li>
            <li><strong>PowerShellProcessManager.cs の複雑度削減</strong>
                <ul>
                    <li>ネストレベル6を4以下に削減</li>
                    <li>状態管理ロジックを別クラスに抽出</li>
                    <li>推定工数: 4時間</li>
                </ul>
            </li>
            <li><strong>エラーハンドリングの強化</strong>
                <ul>
                    <li>PowerShellPrompts.cs、PowerShellService.csにtry-catch追加</li>
                    <li>推定工数: 2時間</li>
                </ul>
            </li>
        </ol>
    </div>

    <div class="recommendation">
        <h3>🟢 優先度: 低（時間があれば対応）</h3>
        <ol>
            <li><strong>NotificationService.cs の整理</strong>
                <ul>
                    <li>コメントアウトされたコード(74行)の削除または実装完了</li>
                    <li>推定工数: 1時間</li>
                </ul>
            </li>
            <li><strong>ユニットテストのカバレッジ向上</strong>
                <ul>
                    <li>CommandClientTest.csの拡充</li>
                    <li>各Cmdletのテストケース追加</li>
                    <li>推定工数: 8時間</li>
                </ul>
            </li>
        </ol>
    </div>

    <h2>📈 品質スコアランキング</h2>
    <h3>TOP 5 優秀なファイル</h3>
    <table>
        <tr>
            <th>順位</th>
            <th>ファイル</th>
            <th>スコア</th>
            <th>コード行数</th>
            <th>XMLコメント</th>
        </tr>    </table>

    <h3>改善が必要なファイル TOP 5</h3>
    <table>
        <tr>
            <th>順位</th>
            <th>ファイル</th>
            <th>スコア</th>
            <th>主な問題</th>
        </tr>    </table>

    <h2>📚 推奨リソースとベストプラクティス</h2>
    <ul>
        <li><strong>C# コーディング規約:</strong> <a href="https://learn.microsoft.com/ja-jp/dotnet/csharp/fundamentals/coding-style/coding-conventions">Microsoft C# コーディング規約</a></li>
        <li><strong>複雑度削減:</strong> Cyclomatic Complexity を10以下に保つことを推奨</li>
        <li><strong>SOLID原則:</strong> 単一責任の原則（SRP）を意識したクラス設計</li>
        <li><strong>XMLドキュメント:</strong> すべてのpublic API に &lt;summary&gt;, &lt;param&gt;, &lt;returns&gt; を記載</li>
        <li><strong>ファイルサイズ:</strong> 1ファイル300行以下を目標に</li>
    </ul>

    <h2>🔄 次回分析時の比較用メトリクス</h2>
    <table>
        <tr>
            <th>メトリクス</th>
            <th>現在値</th>
        </tr>
        <tr><td>総コード行数</td><td>3,230行</td></tr>
        <tr><td>平均品質スコア</td><td>105.9/100</td></tr>
        <tr><td>最大ネストレベル</td><td>8</td></tr>
        <tr><td>XMLコメント不足ファイル</td><td>6個</td></tr>
        <tr><td>大規模ファイル（300行超）</td><td>2個</td></tr>
        <tr><td>エラーハンドリング不足ファイル</td><td>2個</td></tr>
    </table>

    <h2>📝 まとめ</h2>
    <p>PowerShell.MCPプロジェクトは全体的に高品質なコードベースを持っています（平均スコア105.9/100）。主な改善点は以下の通りです：</p>
    <ol>
        <li><strong>TextFileUtility.cs</strong> の複雑度削減が最優先課題</li>
        <li>6ファイルにXMLドキュメントコメントの追加が必要</li>
        <li>命名規則の統一（プライベートフィールド）</li>
        <li>エラーハンドリングの強化</li>
    </ol>
    <p>これらの改善を実施することで、保守性とコードの可読性が大幅に向上します。</p>

    <hr>
    <p style="text-align: center; color: #7f8c8d; font-size: 0.9em;">
        Generated by PowerShell.MCP Code Quality Analyzer | 2025-10-12 19:53:49
    </p>
</div>
</body>
</html>
